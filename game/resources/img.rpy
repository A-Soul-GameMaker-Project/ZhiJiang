###################
# CG、立绘声明
###################



##########
# 立绘
# 立绘的声明：
# 角色名字 + 身体动作 + 表情/情绪 + 其他差分
##########

#####
# 贝拉
#####

image bl normal:
    "tatie/贝拉/常1.png"
    zoom 0.285

image bl normal eyeclosd:
    "tatie/贝拉/常 闭眼.png"
    zoom 0.285

image bl phone:
    "tatie/贝拉/电话.png"
    zoom 0.285

image bl care:
    "tatie/贝拉/关心.png"
    zoom 0.285

image bl anxiety:
    "tatie/贝拉/焦急.png"
    zoom 0.285

image bl shock:
    "tatie/贝拉/惊讶.png"
    zoom 0.285

image bl angery:
    "tatie/贝拉/怒1.png"
    zoom 0.285

image bl pissed:
    "tatie/贝拉/生气.png"
    zoom 0.285

image bl angery sweat:
    "tatie/贝拉/怒汗.png"
    zoom 0.285

image bl sad:
    "tatie/贝拉/哀1.png"
    zoom 0.285

image bl soft:
    "tatie/贝拉/温柔.png"
    zoom 0.285

image bl daze:
    "tatie/贝拉/无神.png"
    zoom 0.285

image bl serious:
    "tatie/贝拉/严肃.png"
    zoom 0.285

image bl doubt:
    "tatie/贝拉/疑惑1.png"
    zoom 0.285

image bl hesitate:
    "tatie/贝拉/犹豫.png"
    zoom 0.285

image bl frown:
    "tatie/贝拉/皱眉.png"
    zoom 0.285

image bl smile: # smile程度比happ低
    "tatie/贝拉/喜1.png"
    zoom 0.285

image bl happy:
    "tatie/贝拉/乐1.png"
    zoom 0.285

#####
# 小贝拉
#####

image bl child:
    "tatie/小贝拉/常态.png"
    zoom 0.35
    yoffset 180

image bl child smile:
    "tatie/小贝拉/微笑1.png"
    zoom 0.35
    yoffset 180

image bl child smile2:
    "tatie/小贝拉/微笑2.png"
    zoom 0.35
    yoffset 180

image bl child sad:
    "tatie/小贝拉/悲伤.png"
    zoom 0.35
    yoffset 180

image bl child 练习:
    "tatie/小贝拉/练习.png"
    zoom 0.37
    yoffset 110
    xoffset 200



#####
# 嘉然
#####
image jr normal:
    "tatie/嘉然/常1.png"
    zoom 0.285
    yoffset 135

image jr embarrassed:
    "tatie/嘉然/尴尬.png"
    zoom 0.285
    yoffset 135

image jr shock:
    "tatie/嘉然/惊讶.png"
    zoom 0.285
    yoffset 135

image jr angery:
    "tatie/嘉然/怒1.png"
    zoom 0.285
    yoffset 135

image jr panic:
    "tatie/嘉然/惊慌.png"
    zoom 0.285
    yoffset 135

image jr sad:
    "tatie/嘉然/哀1.png"
    zoom 0.285
    yoffset 135

image jr sad tears:
    "tatie/嘉然/哀 泪水.png"
    zoom 0.285
    yoffset 135

image jr cry:
    "tatie/嘉然/哭.png"
    zoom 0.285
    yoffset 135

image jr haggard:
    "tatie/嘉然/憔悴.png"
    zoom 0.285
    yoffset 135

image jr lost:
    "tatie/嘉然/失落.png"
    zoom 0.285
    yoffset 135

image jr smile: # smile程度比happ低
    "tatie/嘉然/喜1.png"
    zoom 0.285
    yoffset 135

image jr happy:
    "tatie/嘉然/乐1.png"
    zoom 0.285
    yoffset 135

image jr thinking:
    "tatie/嘉然/思考.png"
    zoom 0.285
    yoffset 135

image jr doubt:
    "tatie/嘉然/疑惑.png"
    zoom 0.285
    yoffset 135

image jr distressed:
    "tatie/嘉然/苦恼.png"
    zoom 0.285
    yoffset 135

image jr laugh:    # 为了统一，所以喜是微笑，这里的微笑的情绪自己把握
    "tatie/嘉然/微笑.png"
    zoom 0.285
    yoffset 135

image jr sacred pray:
    "tatie/圣嘉然/祈祷.png"
    zoom 0.285
    yoffset 115

image jr sacred dignified:
    "tatie/圣嘉然/端庄.png"
    zoom 0.285
    yoffset 115

image jr sacred wind:
    "tatie/圣嘉然/挡风.png"
    zoom 0.285
    yoffset 115


#####
# 乃琳
#####
image nl normal:
    "tatie/乃琳/常1.png"
    zoom 0.285
    yoffset 60

image nl thinking:
    "tatie/乃琳/沉思.png"
    zoom 0.285
    yoffset 60

image nl worried:
    "tatie/乃琳/担忧.png"
    zoom 0.285
    yoffset 60

image nl care:
    "tatie/乃琳/关心.png"
    zoom 0.285
    yoffset 60

image nl surly:
    "tatie/乃琳/忧郁.png"
    zoom 0.285
    yoffset 60

image nl shock:
    "tatie/乃琳/惊讶.png"
    zoom 0.285
    yoffset 60

image nl angery:
    "tatie/乃琳/怒1.png"
    zoom 0.285
    yoffset 60

image nl helpless:
    "tatie/乃琳/无奈.png"
    zoom 0.285
    yoffset 60

image nl gloomy:
    "tatie/乃琳/阴沉.png"
    zoom 0.285
    yoffset 60

image nl sad:
    "tatie/乃琳/哀1.png"
    zoom 0.285
    yoffset 60

image nl frown:
    "tatie/乃琳/皱眉.png"
    zoom 0.285
    yoffset 60

image nl smile: # smile程度比happ低
    "tatie/乃琳/喜1.png"
    zoom 0.285
    yoffset 60

image nl happy:
    "tatie/乃琳/乐1.png"
    zoom 0.285
    yoffset 60

image nl sneer:
    "tatie/乃琳/冷笑.png"
    zoom 0.285
    yoffset 60

image nl blush:
    "tatie/乃琳/脸红.png"
    zoom 0.285
    yoffset 60



#####
# 向晚
#####

image xw normal:
    "tatie/向晚/常1.png"
    zoom 0.285
    yoffset 55

image xw normal eyeclosd:
    "tatie/向晚/常 闭眼.png"
    zoom 0.285
    yoffset 55

image xw worried:
    "tatie/向晚/担忧.png"
    zoom 0.285
    yoffset 55

image xw anxiety:
    "tatie/向晚/皱眉.png"
    zoom 0.285
    yoffset 55

image xw shock:
    "tatie/向晚/吃惊.png"
    zoom 0.285
    yoffset 55

image xw moving:
    "tatie/向晚/感动.png"
    zoom 0.285
    yoffset 55

image xw angery:
    "tatie/向晚/怒1.png"
    zoom 0.285
    yoffset 55

image xw calm:
    "tatie/向晚/平静.png"
    zoom 0.285
    yoffset 55

image xw shy:
    "tatie/向晚/害羞.png"
    zoom 0.285
    yoffset 55

image xw cry:
    "tatie/向晚/哭泣.png"
    zoom 0.285
    yoffset 55

image xw unconcerned :
    "tatie/向晚/冷漠.png"
    zoom 0.285
    yoffset 55

image xw unconcerned frown:
    "tatie/向晚/冷漠 皱眉.png"
    zoom 0.285
    yoffset 55

image xw blush:
    "tatie/向晚/脸红.png"
    zoom 0.285
    yoffset 55

image xw cry2laugh:
    "tatie/向晚/破涕为笑.png"
    zoom 0.285
    yoffset 55

image xw expect:
    "tatie/向晚/期待.png"
    zoom 0.285
    yoffset 55

image xw wronged:
    "tatie/向晚/委屈.png"
    zoom 0.285
    yoffset 55

image xw sad:
    "tatie/向晚/哀1.png"
    zoom 0.285
    yoffset 55

image xw gloomy:
    "tatie/向晚/忧郁.png"
    zoom 0.285
    yoffset 55

image xw proud:
    "tatie/向晚/傲娇.png"
    zoom 0.285
    yoffset 55

image xw despair:
    "tatie/向晚/绝望.png"
    zoom 0.285
    yoffset 55

image xw smile: # smile程度比happ低
    "tatie/向晚/喜1.png"
    zoom 0.285
    yoffset 55

image xw happy:
    "tatie/向晚/乐1.png"
    zoom 0.285
    yoffset 55

image xw doubt:
    "tatie/向晚/疑惑.png"
    zoom 0.285
    yoffset 55

image xw frown:
    "tatie/向晚/皱眉.png"
    zoom 0.285
    yoffset 55



#####
# 珈乐
#####

image jl normal:
    "tatie/珈乐/常1.png"
    zoom 0.285
    yoffset 35

image jl normal eyeclosd:
    "tatie/珈乐/常 闭眼.png"
    zoom 0.285
    yoffset 35

image jl firm:
    "tatie/珈乐/坚定.png"
    zoom 0.285
    yoffset 35

image jl anxiety:
    "tatie/珈乐/焦虑.png"
    zoom 0.285
    yoffset 35

image jl pain:
    "tatie/珈乐/痛苦.png"
    zoom 0.285
    yoffset 35

image jl angery:
    "tatie/珈乐/怒1.png"
    zoom 0.285
    yoffset 35

image jl helpless:
    "tatie/珈乐/无奈.png"
    zoom 0.285
    yoffset 35

image jl sad:
    "tatie/珈乐/哀1.png"
    zoom 0.285
    yoffset 35

image jl sad2:
    "tatie/珈乐/哀2.png"
    zoom 0.285
    yoffset 35

image jl doubt:
    "tatie/珈乐/疑惑.png"
    zoom 0.285
    yoffset 35

image jl smile: # smile程度比happ低
    "tatie/珈乐/喜1.png"
    zoom 0.285
    yoffset 35

image jl happy:
    "tatie/珈乐/乐1.png"
    zoom 0.285
    yoffset 35

image jl shock:
    "tatie/珈乐/吃惊.png"
    zoom 0.285
    yoffset 35

image jl worried:
    "tatie/珈乐/担忧.png"
    zoom 0.285
    yoffset 35

image jl child:
    "tatie/小珈乐/常.png"
    zoom 0.35
    yoffset 870
image jl child smile:
    "tatie/小珈乐/笑.png"
    zoom 0.35
    yoffset 870

image jl child sad:
    "tatie/小珈乐/哀.png"
    zoom 0.35
    yoffset 870

image jl child expect:
    "tatie/小珈乐/憧憬.png"
    zoom 0.35
    yoffset 870

#####
# 阿草
#####

image ac normal:
    "tatie/阿草/普通.png"
    zoom 0.285

image ac sad:
    "tatie/阿草/悲伤.png"
    zoom 0.285

image ac proud:
    "tatie/阿草/得意.png"
    zoom 0.285

image ac angery:
    "tatie/阿草/愤怒.png"
    zoom 0.285

image ac happy:
    "tatie/阿草/高兴.png"
    zoom 0.285

image ac panic:
    "tatie/阿草/惊慌.png"
    zoom 0.285

image ac afraid:
    "tatie/阿草/恐怖.png"
    zoom 0.285

## 配角

image baoan:
    "tatie/保安剪影.png"
    zoom 0.575
    yoffset 330
    xoffset 20

image fz:
    "tatie/方丈剪影.png"
    zoom 1.25
    yoffset 600

image gj:
    "tatie/管家剪影.png"
    zoom .97
    yoffset 250
    xoffset -200

#########################################
# 背景 与 CG
#
#
# 对于所有的 CG 与 背景 应使用如下实现声明
#     declare('bg2', 'test1.png')
#     declare(name, path)


#######背景
image white = Solid("#fff")
image black = "#000"


#############
# 场景声明
# 注意使用 declare declare_multiple

#  示例  declare('bg2', 'test2.png', 'p')
init python:
    declare('直播用房间', 'bg/0 直播用房间.png', 'p')
    declare('枝江大厦前台', 'bg/1 4枝江大厦一楼前台.png', 'p')
    declare('病房房间', 'bg/0 3 病房.png', 'p')
    declare('病房房间晚上', 'bg/5 病房(晚).png', 'p')
    declare('医院走廊1', 'bg/1 医院走廊1.png', 'p')
    declare('医院走廊2', 'bg/1 医院走廊2.png', 'p')
    declare('枝江街头', 'bg/1 2枝江街头.png', 'p')
    declare('枝江街头1', 'bg/1 2枝江街头1.png', 'p')
    declare('枝江街头1黄昏', 'bg/1 枝江街头(黄昏).png', 'p')

    declare('街道0', 'bg/2 一条人很多的街道.png', 'p')
    
    declare('枝江街道夜晚', 'bg/4 一条人很多的街道(晚).png', 'p')

    declare('珈蓝寺', 'bg/4 珈蓝寺.png', 'p')
    declare( 'NightStreet' ,"bg/2 5 街道（夜）.png", 'p')
    declare( 'LivingRoom_light',"bg/2 7 客厅.png", 'p')
    declare( 'tiantai',"bg/1 9 天台.png", 'p')
    declare( 'officeRoom',"bg/1 3 4 阿草办公室.png", 'p')

    declare( '夜空满月',"bg/2 5 夜空（满月）.png", 'p')
    declare( '夜空诡月',"bg/2 5 夜空（诡月）.png", 'p')

    declare( '客厅夜',"bg/2 7 客厅.png", 'p')
    declare('客厅熄灯','bg/2 7 客厅(熄灯).png','p')
    declare('休息室内','bg/8 2 纯白房间(休息室).png','p')
    declare('人群晚','bg/8 人群(晚).png','p')
    declare('电梯透明','bg/82 电梯人群.png','p')
    declare('电梯内部','bg/1 82电梯内部.png','p')

    declare('电梯井','bg/4 电梯井.png','p')
    declare('练舞室','bg/3 练舞室.png','p')
    declare('枝江边上','bg/4 枝江边上.png','p')
    declare('购物中心午','bg/7 8购物中心_中午.png','p')
    declare('购物中心早','bg/7 8购物中心_早.png','p')
    declare('购物中心晚','bg/7 8购物中心_夜晚.png','p')
    declare('贝叶庙','bg/7 贝拉庙.png','p')
    declare('玄关熄灯','bg/7 玄关_熄灯.png','p')
    # declare('客厅_熄灯','','p')
    declare('浴室晚','bg/7 浴室_晚.png','p')
    # declare('客厅_晚','','p')
    # declare('月_云','','p')
    declare('水面空间碎裂','bg/TE 水面空间(天空碎裂).png','p')
    declare('水面空间晚','bg/TE 水面空间(晚).png','p')
    declare('水面空间早','bg/TE 水面空间(早).png','p')
    declare('水面空间','bg/TE 水面空间（空）.png','p')
    declare('嘉然房间','bg/75 嘉然房间内.png','p')
    declare('总控制室','bg/3 总控制室.png','p')
    declare('枝江市广景','bg/枝江市广景.png','p')
    declare('半月云','bg/7 半月_云.png','p')

    declare('天空阴沉','bg/5 天空(阴).png','p')
    declare('天空晴','bg/5 天空(晴).png','p')

    declare('道路夜','bg/8 5道路(夜).png','p')

    declare('枝江大厦外 昼','bg/1 4 5枝江大厦外景(白天).png','p')
    declare('枝江大厦外 夜','bg/1 4 5枝江大厦外景(夜晚).png','p')

    declare('阿草办公室 夜','bg/5 阿草办公室.png','p')

    declare('鲜花阳光','bg/9 鲜花阳光.png','p')

    declare('枝江天台','bg/82 9枝江大厦天台(未充能).png','p')
    declare('枝江天台1','bg/82 9枝江大厦天台.png','p')
    declare('枝江天台克苏鲁','bg/82 9枝江大厦天台(克).png','p')


    declare('NE城市远景','bg/NE城市远景(克).png','p')
    declare('NE人群街头','bg/NE人群街头(克).png','p')

    declare('图书馆', 'bg/2 图书馆.png', 'p')

    declare('双人卧室', 'bg/嘉然向晚双人卧室.png', 'p')
    declare('双人卧室夜', 'bg/嘉然向晚卧室(夜).png', 'p')

    declare('排行榜', 'bg/9 学校排行榜.png', 'p')
    declare('水族馆', 'bg/水族馆.png', 'p')

    declare('晚晚家', 'bg/向晚家客厅.png', 'p')

    declare('枝江大厦幕墙', 'bg/3 枝江大厦幕墙.png', 'p')


###########
## 视频


image 嘉晚饭 = Movie(play='audio/video/嘉晚饭.webm', size=(1600, 900),loop=False)
image 贝贝珈 = Movie(play='audio/video/贝贝珈.webm', size=(1600, 900),loop=False)

image 顺时针 = Movie(play='audio/video/顺时针.webm', size=(1600, 900),loop=False)
image 逆时针 = Movie(play='audio/video/逆时针.webm', size=(1600, 900),loop=False)


#############
# CG声明
# 注意使用 declare declare_multiple

#  示例  declare('bg2', 'test2.png', 'p')
init  python:
    cg_name_list = []
    thumbnail_x = 250
    thumbnail_y = 150

    declare('locked', "cg/locked.png", 'p', x=thumbnail_x, y=thumbnail_y)



    g = Gallery()
    g.transition = dissolve


    g.button("门口向晚")
    g.unlock_image(declare('门口向晚', 'CG/门口xw/1.png', 'p', gallery=True))

    g.button("争吵")
    g.unlock_image(declare('争吵', 'CG/争吵/1.jpg', 'p', gallery=True))

    g.button("监控室珈乐")
    g.unlock_image(declare('监控室珈乐', 'CG/珈乐监控室/1.jpg', 'p', gallery=True))
    g.unlock_image(declare('监控室珈乐2', 'CG/珈乐监控室/2.jpg', 'p'))

    g.button("贝拉战斗1")
    g.unlock_image(declare('贝拉战斗1', 'CG/贝拉战斗/1.png', 'p', gallery=True))
    g.unlock_image(declare('贝拉战斗2', 'CG/贝拉战斗/2.png', 'p'))

    g.button("乃琳CG")
    g.unlock_image(declare('乃琳CG', 'CG/乃琳/1.jpg', 'p', gallery=True))

    g.button("草莓蛋糕")
    g.unlock_image(declare('草莓蛋糕', 'CG/草莓蛋糕/1.png', 'p', gallery=True))
    g.unlock_image(declare('草莓蛋糕1', 'CG/草莓蛋糕/2.png', 'p'))

    g.button("分海CG")
    g.unlock_image(declare('分海CG', 'CG/分海/1.png', 'p', gallery=True))

    g.button("嘉然晚晚")
    g.unlock_image(declare('嘉然晚晚', 'CG/嘉然晚晚/1.jpg', 'p', gallery=True))

    g.button("帷幕之末")
    g.unlock_image(declare('帷幕之末', 'CG/帷幕之末/1.png', 'p', gallery=True))

    g.button("嘉然逆光")
    g.unlock_image(declare('嘉然逆光', 'CG/嘉然逆光/1.png', 'p', gallery=True))
    g.image(declare('嘉然逆光2', 'CG/嘉然逆光/2.png', 'p'))
    g.unlock('嘉然逆光')

    g.button("牵手")
    g.unlock_image(declare('牵手', 'CG/牵手CG/1.jpg', 'p', gallery=True))


    g.button("献祭1")
    g.unlock_image(declare('献祭1', 'CG/献祭/1.png', 'p', gallery=True))
    g.unlock_image(declare('献祭2', 'CG/献祭/2.png', 'p'))
    g.image(declare('献祭3', 'CG/献祭/3.jpg', 'p'))
    g.unlock('献祭2')

    g.button("嘉然牺牲")
    g.unlock_image(declare('嘉然牺牲', 'CG/neCG/1.png', 'p', gallery=True))

    g.button("刺杀阿草")
    g.unlock_image(declare('刺杀阿草', 'CG/ge向晚CG/1.png', 'p', gallery=True))

    g.button("英雄CG")
    g.unlock_image(declare('英雄CG', 'CG/hero/1.png', 'p', gallery=True))

    g.button("拥抱1")
    g.unlock_image(declare('拥抱1', 'CG/ge拥抱/1.jpg', 'p', gallery=True))
    g.unlock_image(declare('拥抱2', 'CG/ge拥抱/2.jpg', 'p'))
    g.unlock_image(declare('拥抱3', 'CG/ge拥抱/3.jpg', 'p'))
    g.unlock_image(declare('拥抱4', 'CG/ge拥抱/4.jpg', 'p'))
    g.unlock_image(declare('拥抱5', 'CG/ge拥抱/5.jpg', 'p'))

    g.button("项链")
    g.unlock_image(declare('项链', 'CG/项链/1.png', 'p', gallery=True))


    g.button("海底向晚1")
    g.unlock_image(declare('海底向晚1', 'CG/TE海底/1.png', 'p', gallery=True))
    g.unlock_image(declare('海底向晚2', 'CG/TE海底/2.png', 'p'))
    g.unlock_image(declare('海底向晚3', 'CG/TE海底/3.png', 'p'))
    g.unlock_image(declare('海底向晚4', 'CG/TE海底/4.png', 'p'))


    g.button("TE演唱会")
    g.unlock_image(declare('TE演唱会', 'CG/te/1.jpg', 'p', gallery=True))


#############
# 图片声明组件
#############

init -1 python:

    class ProportionalScale(im.ImageBase):
        '''Resizes a renpy image to fit into the specified width and height.
        The aspect ratio of the image will be conserved.'''
        #调整renpy图像的大小以适应指定的宽度和高度。
        #长宽比的图像将被保存。

        def __init__(self, imgname, maxwidth, maxheight, bilinear=True, **properties):
            img = im.image(imgname)
            super(ProportionalScale, self).__init__(img, maxwidth, maxheight, bilinear, **properties)
            self.imgname = imgname
            self.image = img
            self.maxwidth = int(maxwidth)
            self.maxheight = int(maxheight)
            self.bilinear = bilinear

        def load(self):
            child = im.cache.get(self.image)
            width, height = child.get_size()

            ratio = min(self.maxwidth/float(width), self.maxheight/float(height))
            width = ratio * width
            height = ratio * height

            if self.bilinear:
                try:
                    renpy.display.render.blit_lock.acquire()
                    rv = renpy.display.scale.smoothscale(child, (width, height))
                finally:
                    renpy.display.render.blit_lock.release()
            else:
                try:
                    renpy.display.render.blit_lock.acquire()
                    rv = renpy.display.pgrender.transform_scale(child, (newwidth, newheight))
                finally:
                    renpy.display.render.blit_lock.release()
            return rv

        def predict_files(self):
            return self.image.predict_files()

    def declare(name, img, method="p", x=config.screen_width, y=config.screen_height, wide=False, gallery=False, unlock=False):
        # img is the complete image path (from the game folder root) img是完整的图像路径(来自游戏文件夹根目录)

        # if wide:
        #    y = int(y*0.8)


        if method == "s": #  比例尺法(图像将适合准确的目标尺寸-不成比例)
            renpy.image(name, im.Scale(img, x, y))

        elif method == "p": #  比例比例尺法(图像拟合目标尺寸，同时保持长宽比)
            renpy.image(name, ProportionalScale(img,x, y))

        elif method == "f": #  因子比例(图像尺寸将按比例变化为浮点数x和y)

            # Foolproofing
            if x == config.screen_width:
                x = 1.0
            if y == config.screen_height:
                y = 1.0

            renpy.image(name, im.FactorScale(img, x, y))

        else: # 原图不变
            renpy.image(name, img)

        if gallery: #  如果要将图像存储在图库中，则返回图像名称
            small_img = img[:img.rfind('/')] + '/small.png'
            declare(name + '_s', img, 'p', x=thumbnail_x, y=thumbnail_y)
            cg_name_list.append(name)
        return name
    # 声明多个
    def declare_multiple(base_name, base_img, method=None, start=0, finish=0, series=[], x=config.screen_width, y=config.screen_height, wide=False, gallery=True, unlock=False, loud=False):
        r = []

        if not series:
            series = range(start, finish+1)

        for nb in series:
            name, img = base_name % str(nb), base_img % str(nb)

            r.append(declare(name, img, method=method, x=x, y=y, wide=wide, gallery=gallery, unlock=unlock))

        return r
